\begin{figure}
	\centering
\begin{tikzpicture}
	\centering
	\matrix (mtr) [matrix of nodes,row sep=-\pgflinewidth, nodes={draw}]
	{
		1 & |[fill=red!30]| 2 & |[fill=red!30]| 3  & 0\\
		1 & |[fill=red!30]| 1 & |[fill=red!30]| 1  & 0\\
		0 & 1 & 1  & 0\\
		2 & 5 & 0  & 0\\
	};

	\draw[very thick, red] (mtr-1-2.north west) rectangle (mtr-2-3.south east);

	\node [below= of mtr-5-4.south] (lm) {$\bf I$};

	\matrix (ret) [right=4em of mtr,matrix of nodes,row sep=-\pgflinewidth, nodes={draw}]
	{
	  2 & |[fill=green!30]| 3 & 3\\
	  1 & 1 & 1\\
	  5 & 5 & 0\\
	};

	\node [below = of ret-3-2.south] (lk) {$\bf maxpool(I)$};

	\draw[very thick, green] (ret-1-2.north west) rectangle (ret-1-2.south east);

	\draw[densely dotted, green, thick] (mtr-1-2.north west) -- (ret-1-2.north west);
	\draw[densely dotted, green, thick] (mtr-2-2.south west) -- (ret-1-2.south west);
	\draw[densely dotted, green, thick] (mtr-1-3.north east) -- (ret-1-2.north east);
	\draw[densely dotted, green, thick] (mtr-2-3.south east) -- (ret-1-2.south east);

\end{tikzpicture}
\caption{Illustration of $2\times2$ 2D maximum pooling with valid padding.}
\label{2dpool}
\end{figure}